<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <title>GeliÅŸmiÅŸ Arama</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }

        form {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #007bff;
            border-radius: 5px;
            background-color: #f7faff;
        }

        input[type="text"] {
            padding: 10px;
            width: 60%;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            font-size: 0.9em;
        }

        .sonuc-baslik {
            border-bottom: 2px solid #ddd;
            padding-bottom: 5px;
            margin-top: 30px;
        }
    </style>
</head>

<body>
    <h1>ğŸ” GeliÅŸmiÅŸ Arama</h1>
    <p><a href="{% url 'ana_sayfa' %}">â† Ana Sayfaya Geri DÃ¶n</a> |
        <a href="{% url 'musteri_listesi' %}">MÃ¼ÅŸteriler</a> |
        <a href="{% url 'ilan_listesi' %}">Ä°lanlar</a>
    </p>

    <form method="GET" action="{% url 'gelismis_arama' %}">
        <label for="q">Ä°lan No, Ä°l, Ä°lÃ§e, Ad Soyad veya Telefon ile arayÄ±n:</label><br>
        <input type="text" id="q" name="q" value="{{ sorgu|default:'' }}" placeholder="Arama terimini girin..."
            required>
        <button type="submit">Ara</button>
    </form>

    {% if sorgu %}
    <h2>SonuÃ§lar: "{{ sorgu }}"</h2>

    <h3 class="sonuc-baslik">ğŸ‘¤ MÃ¼ÅŸteri SonuÃ§larÄ± ({{ musteri_sonuclari.count }} adet)</h3>
    {% if musteri_sonuclari %}
    <table>
        <thead>
            <tr>
                <th>AdÄ± SoyadÄ±</th>
                <th>Telefon</th>
                <th>RolÃ¼</th>
                <th>KayÄ±t Tarihi</th>
            </tr>
        </thead>
        <tbody>
            {% for musteri in musteri_sonuclari %}
            <tr>
                <td><a href="{% url 'musteri_detay' pk=musteri.pk %}">{{ musteri.ad_soyad }}</a></td>
                <td>{{ musteri.telefon }}</td>
                <td>{{ musteri.get_rol_display }}</td>
                <td>{{ musteri.kayit_tarihi|date:"d.m.Y" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>MÃ¼ÅŸteri kayÄ±tlarÄ±nda eÅŸleÅŸme bulunamadÄ±.</p>
    {% endif %}

    <h3 class="sonuc-baslik">ğŸ¡ Ä°lan SonuÃ§larÄ± ({{ ilan_sonuclari.count }} adet)</h3>
    {% if ilan_sonuclari %}
    <table>
        <thead>
            <tr>
                <th>Ä°lan No</th>
                <th>Konum</th>
                <th>Oda</th>
                <th>Fiyat</th>
                <th>Durum</th>
            </tr>
        </thead>
        <tbody>
            {% for ilan in ilan_sonuclari %}
            <tr>
                <td><a href="{% url 'ilan_detay' pk=ilan.pk %}">{{ ilan.ilan_no }}</a></td>
                <td>{{ ilan.il }} / {{ ilan.ilce }}</td>
                <td>{{ ilan.oda_sayisi }}</td>
                <td>{{ ilan.fiyat|floatformat:0 }} TL</td>
                <td>{{ ilan.get_durum_display }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>Ä°lan kayÄ±tlarÄ±nda eÅŸleÅŸme bulunamadÄ±.</p>
    {% endif %}

    {% else %}
    <p>Arama yapmak iÃ§in yukarÄ±daki alanÄ± kullanÄ±n.</p>
    {% endif %}
</body>

</html>